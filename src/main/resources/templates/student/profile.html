<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Profile</title>
    <link rel="stylesheet" th:href="@{/css/tailwind.css}">
</head>
<body class="bg-gray-100 min-h-screen">
<div th:replace="~{layout/header :: header}"></div>
<div class="max-w-6xl mx-auto p-6">

    <!-- Header -->
    <h1 class="text-3xl font-bold text-gray-800 mb-6">üéì Student Profile</h1>

    <!-- Messages -->
    <div th:if="${param.success}" class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded shadow-sm">
        <p><strong>‚úÖ Success:</strong> <span th:text="${param.success[0]}"></span></p>
    </div>
    <div th:if="${param.error}" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded shadow-sm">
        <p><strong>‚ùå Error:</strong> <span th:text="${param.error[0]}"></span></p>
    </div>

    <!-- Layout -->
    <div class="max-w-6xl mx-auto p-6 flex flex-col md:flex-row gap-6">

        <!-- Sidebar -->
        <aside class="md:w-1/3 bg-white rounded-2xl shadow-xl p-6 sticky top-6">
            <div class="flex flex-col items-center">
                <!-- Profile Image -->
                <div class="relative w-32 h-32 mb-4">
                    <img th:src="${user.userImage ?: 'https://img.freepik.com/premium-vector/default-image-icon-vector-missing-picture-page-website-design-mobile-app-no-photo-available_87543-11093.jpg'}"
                        alt="Profile"
                        class="w-32 h-32 rounded-full border-4 border-gradient-to-r from-teal-400 to-cyan-400 shadow-lg object-cover"/>
                </div>
                <p class="font-bold text-xl text-gray-800 mb-1" th:text="${user.firstName + ' ' + user.lastName}">Student Name</p>
                <p class="text-gray-500 mb-4" th:text="${user.email}">email@example.com</p>

                <!-- Upload Image -->
                <form th:action="@{/student/profile/upload-image}" method="post" enctype="multipart/form-data" class="w-full">
                    <label class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white font-medium rounded-lg shadow-lg cursor-pointer transition">
                        Upload Image
                        <input type="file" name="image" accept="image/*" class="hidden"/>
                    </label>
                    <button type="submit" class="mt-3 w-full bg-gradient-to-r from-green-400 to-green-500 hover:from-green-500 hover:to-green-600 text-white py-2 rounded-lg font-semibold shadow-md transition">
                        Change Photo
                    </button>
                </form>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="md:w-2/3 space-y-6">

            <!-- Personal Info -->
            <section class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b pb-2">üë§ Personal Information</h2>
                <form th:action="@{/student/profile/update}" method="post" th:object="${profile}" class="space-y-4">

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">First Name</label>
                            <input type="text" th:field="*{firstName}" 
                                class="w-full px-4 py-2 rounded-md border border-gray-300 bg-gray-50 focus:ring-2 focus:ring-teal-400 focus:outline-none"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Last Name</label>
                            <input type="text" th:field="*{lastName}" 
                                class="w-full px-4 py-2 rounded-md border border-gray-300 bg-gray-50 focus:ring-2 focus:ring-teal-400 focus:outline-none"/>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" th:field="*{email}" 
                            class="w-full px-4 py-2 rounded-md border border-gray-300 bg-gray-50 focus:ring-2 focus:ring-teal-400 focus:outline-none"/>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700">Date of Birth</label>

                        <!-- Display current date nicely -->
                        <p class="text-gray-500 mb-2">
                            Current DOB: 
                            <span th:text="${#temporals.format(profile.dob, 'dd/MM/yyyy')}">01/01/2000</span>
                        </p>

                        <!-- Editable input -->
                        <input type="date" th:field="*{dob}" 
                            class="w-full px-4 py-2 rounded-md border border-gray-300 bg-gray-50 focus:ring-2 focus:ring-teal-400 focus:outline-none"/>
                    </div>

                    <button type="submit" 
                            class="w-full bg-gradient-to-r from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white py-3 rounded-lg font-semibold shadow-lg transition-transform transform hover:-translate-y-1">
                        Save Changes
                    </button>
                </form>
            </section>


            <!-- Enrolled Courses -->
            <section class="bg-white rounded-2xl shadow-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b pb-2">üìö My Enrolled Courses</h2>
                <div th:if="${#lists.isEmpty(enrolledCourses)}" class="text-gray-500 text-center py-6">
                    You haven't enrolled in any courses yet.
                </div>
                <div th:each="enrollment : ${enrolledCourses}" class="flex flex-col sm:flex-row sm:items-center justify-between p-4 bg-blue-50 rounded-xl shadow-sm mb-3">
                    <div>
                        <p class="font-semibold text-gray-800" th:text="${enrollment.courseName}">Course Name</p>
                        <p class="text-gray-500 text-sm" th:text="${enrollment.credits} + ' credits'">3 credits</p>
                        <p class="text-gray-400 text-xs" th:text="${#temporals.format(enrollment.enrollmentDate,'dd/MM/yyyy')}">28/12/2025</p>
                    </div>
                    <form th:action="@{/student/profile/drop-enrollment}" method="post">
                        <input type="hidden" name="enrollmentId" th:value="${enrollment.id}" />
                        <button type="submit" class="mt-2 sm:mt-0 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium shadow">
                            Drop
                        </button>
                    </form>
                </div>
            </section>
        </main>
    </div>


</div>
<div th:replace="~{layout/footer :: footer}"></div>
</body>
</html>
